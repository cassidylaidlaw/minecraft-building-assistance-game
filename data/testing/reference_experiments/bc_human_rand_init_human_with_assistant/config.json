{
  "_no_train": false,
  "action_reward": 0,
  "action_space": {
    "py/id": 64
  },
  "add_dirichlet_noise": true,
  "anchor_policy_kl_coeff": 0.0,
  "anchor_policy_mapping": {},
  "anchor_policy_reverse_kl": false,
  "area_sample": true,
  "area_sample_config": {
    "interpolate": true,
    "interpolation_order": 1,
    "max_scaling_factor": 2,
    "max_scaling_factor_ratio": 1.5,
    "preserve_paths": true,
    "scale_y_independently": true
  },
  "argmax_tree_policy": false,
  "attention_resolutions": [],
  "batch_mode": "truncate_episodes",
  "channel_mult": [
    1,
    2,
    4
  ],
  "checkpoint_name": "none",
  "checkpoint_path": null,
  "checkpoint_to_load_policies": null,
  "clip_param": 0.05,
  "compress_observations": true,
  "config": {
    "_AlgorithmConfig__prior_exploration_config": null,
    "_disable_action_flattening": false,
    "_disable_execution_plan_api": true,
    "_disable_initialize_loss_from_dummy_batch": false,
    "_disable_preprocessor_api": false,
    "_enable_learner_api": false,
    "_enable_rl_module_api": false,
    "_fake_gpus": false,
    "_is_atari": null,
    "_is_frozen": false,
    "_learner_class": null,
    "_tf_policy_handles_more_than_one_loss": false,
    "action_mask_key": "action_mask",
    "action_space": null,
    "actions_in_input_normalized": true,
    "algo_class": null,
    "algorithm_config_overrides_per_module": {},
    "always_attach_evaluation_results": false,
    "auto_wrap_old_gym_envs": true,
    "batch_mode": "truncate_episodes",
    "buffer_size": -1,
    "callbacks_class": {
      "py/type": "mbag.rllib.callbacks.MbagCallbacks"
    },
    "checkpoint_trainable_policies_only": false,
    "clip_actions": false,
    "clip_rewards": null,
    "collect_metrics_timeout": -1,
    "compress_observations": true,
    "count_steps_by": "env_steps",
    "create_env_on_local_worker": false,
    "custom_evaluation_function": null,
    "custom_resources_per_worker": {},
    "data_augmentation": {
      "py/function": "mbag.scripts.train.data_augmentation"
    },
    "delay_between_worker_restarts_s": 60.0,
    "disable_env_checking": false,
    "eager_max_retraces": 20,
    "eager_tracing": true,
    "enable_async_evaluation": false,
    "enable_connectors": true,
    "enable_tf1_exec_eagerly": false,
    "entropy_coeff": 0,
    "env": "MBAGFlatActions-v1",
    "env_config": {
      "abilities": {
        "flying": true,
        "inf_blocks": true,
        "teleportation": false
      },
      "goal_generator": {
        "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
      },
      "goal_generator_config": {
        "goal_generator": "craftassist",
        "goal_generator_config": {
          "subset": "train"
        },
        "transforms": [
          {
            "config": {
              "connectivity": 18
            },
            "transform": "largest_cc"
          },
          {
            "transform": "crop_air"
          },
          {
            "config": {
              "density_threshold": 0.1
            },
            "transform": "crop_low_density_bottom_layers"
          },
          {
            "config": {
              "min_size": [
                4,
                4,
                4
              ]
            },
            "transform": "min_size_filter"
          },
          {
            "config": {
              "interpolate": true,
              "interpolation_order": 1,
              "max_scaling_factor": 2,
              "max_scaling_factor_ratio": 1.5,
              "preserve_paths": true,
              "scale_y_independently": true
            },
            "transform": "area_sample"
          },
          {
            "config": {
              "max_density": 1,
              "min_density": 0
            },
            "transform": "density_filter"
          },
          {
            "transform": "randomly_place"
          },
          {
            "transform": "add_grass"
          },
          {
            "config": {
              "connectivity": 18
            },
            "transform": "single_cc_filter"
          }
        ]
      },
      "horizon": 1500,
      "malmo": {
        "use_malmo": false
      },
      "num_players": 2,
      "players": [
        {
          "goal_visible": true,
          "is_human": false,
          "player_name": "human",
          "rewards": {},
          "timestep_skip": 1
        },
        {
          "goal_visible": true,
          "is_human": false,
          "rewards": {},
          "timestep_skip": 1
        }
      ],
      "random_start_locations": true,
      "randomize_first_episode_length": true,
      "rewards": {
        "action": 0,
        "get_resources": 0,
        "incorrect_action": 0,
        "noop": 0,
        "own_reward_prop": 0,
        "place_wrong": -1
      },
      "truncate_on_no_progress_timesteps": null,
      "world_size": [
        11,
        10,
        10
      ]
    },
    "env_runner_cls": null,
    "env_task_fn": null,
    "evaluation_config": {
      "env_config": {
        "num_players": 1,
        "players": [
          {
            "goal_visible": true,
            "is_human": false,
            "rewards": {},
            "timestep_skip": 1
          }
        ],
        "randomize_first_episode_length": false
      },
      "explore": true,
      "input": "sampler"
    },
    "evaluation_duration": 64,
    "evaluation_duration_unit": "episodes",
    "evaluation_interval": 1,
    "evaluation_num_episodes": -1,
    "evaluation_num_workers": 8,
    "evaluation_parallel_to_training": false,
    "evaluation_sample_timeout_s": 180.0,
    "exploration_config": {
      "type": "StochasticSampling"
    },
    "explore": true,
    "export_native_model_files": false,
    "extra_python_environs_for_driver": {},
    "extra_python_environs_for_worker": {},
    "fake_sampler": false,
    "framework_str": "torch",
    "gamma": 0.95,
    "grad_clip": 10,
    "grad_clip_by": "global_norm",
    "ignore_worker_failures": false,
    "in_evaluation": false,
    "input_": "data/human_data_cleaned/human_with_assistant/infinite_blocks_true/rllib_with_own_noops_flat_actions_flat_observations_place_wrong_reward_-1_repaired_player_1_inventory_0_1",
    "input_config": {},
    "input_evaluation": -1,
    "keep_per_episode_custom_metrics": false,
    "learning_starts": -1,
    "local_gpu_idx": 0,
    "local_tf_session_args": {
      "inter_op_parallelism_threads": 8,
      "intra_op_parallelism_threads": 8
    },
    "log_level": "WARN",
    "log_sys_usage": true,
    "logger_config": null,
    "logger_creator": null,
    "lr": 0.001,
    "lr_schedule": [
      [
        0,
        0.001
      ],
      [
        195180.0,
        0.0001
      ]
    ],
    "max_num_worker_restarts": 1000,
    "max_requests_in_flight_per_sampler_worker": 2,
    "metrics_episode_collection_timeout_s": 60.0,
    "metrics_num_episodes_for_smoothing": 100,
    "metrics_smoothing_episodes": -1,
    "min_iter_time_s": -1,
    "min_sample_timesteps_per_iteration": 0,
    "min_sample_timesteps_per_reporting": -1,
    "min_time_s_per_iteration": null,
    "min_time_s_per_reporting": -1,
    "min_train_timesteps_per_iteration": 0,
    "min_train_timesteps_per_reporting": -1,
    "model": {
      "_disable_action_flattening": false,
      "_disable_preprocessor_api": false,
      "_time_major": false,
      "_use_default_native_models": -1,
      "always_check_shapes": false,
      "attention_dim": 64,
      "attention_head_dim": 32,
      "attention_init_gru_gate_bias": 2.0,
      "attention_memory_inference": 50,
      "attention_memory_training": 50,
      "attention_num_heads": 1,
      "attention_num_transformer_units": 1,
      "attention_position_wise_mlp_dim": 32,
      "attention_use_n_prev_actions": 0,
      "attention_use_n_prev_rewards": 0,
      "conv_activation": "relu",
      "conv_filters": null,
      "custom_action_dist": null,
      "custom_model": null,
      "custom_model_config": {},
      "custom_preprocessor": null,
      "dim": 84,
      "encoder_latent_dim": null,
      "fcnet_activation": "tanh",
      "fcnet_hiddens": [
        256,
        256
      ],
      "framestack": true,
      "free_log_std": false,
      "grayscale": false,
      "lstm_cell_size": 256,
      "lstm_use_prev_action": false,
      "lstm_use_prev_action_reward": -1,
      "lstm_use_prev_reward": false,
      "max_seq_len": 20,
      "no_final_linear": false,
      "post_fcnet_activation": "relu",
      "post_fcnet_hiddens": [],
      "use_attention": false,
      "use_lstm": false,
      "vf_share_layers": true,
      "zero_mean": true
    },
    "monitor": -1,
    "normalize_actions": true,
    "num_consecutive_worker_failures_tolerance": 100,
    "num_cpus_for_local_worker": 1,
    "num_cpus_per_learner_worker": 1,
    "num_cpus_per_worker": 0.5,
    "num_envs_per_worker": 8,
    "num_gpus": 1.0,
    "num_gpus_per_learner_worker": 0,
    "num_gpus_per_worker": 0.0625,
    "num_learner_workers": 0,
    "num_rollout_workers": 0,
    "num_sgd_iter": 1,
    "observation_filter": "NoFilter",
    "observation_fn": null,
    "observation_space": null,
    "off_policy_estimation_methods": {},
    "offline_sampling": false,
    "ope_split_batch_by_episode": true,
    "optimizer": {
      "weight_decay": 0
    },
    "output": null,
    "output_compress_columns": [
      "obs",
      "new_obs"
    ],
    "output_config": {},
    "output_max_file_size": 67108864,
    "placement_strategy": "PACK",
    "policies": {
      "human": {
        "action_space": {
          "_np_random": null,
          "_shape": {
            "py/tuple": []
          },
          "dtype": {
            "dtype": "int64",
            "py/object": "numpy.dtype[int64]"
          },
          "n": {
            "dtype": "int64",
            "py/object": "numpy.int64",
            "value": 12107
          },
          "py/object": "gymnasium.spaces.discrete.Discrete",
          "start": {
            "dtype": "int64",
            "py/object": "numpy.int64",
            "value": 0
          }
        },
        "config": {
          "goal_loss_coeff": 0.5,
          "model": {
            "custom_action_dist": "categorical_no_inf",
            "custom_model": "mbag_convolutional_model",
            "custom_model_config": {
              "dropout": 0.7,
              "embedding_size": 16,
              "env_config": {
                "abilities": {
                  "flying": true,
                  "inf_blocks": true,
                  "teleportation": false
                },
                "goal_generator": {
                  "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
                },
                "goal_generator_config": {
                  "goal_generator": "craftassist",
                  "goal_generator_config": {
                    "subset": "train"
                  },
                  "transforms": [
                    {
                      "config": {
                        "connectivity": 18
                      },
                      "transform": "largest_cc"
                    },
                    {
                      "transform": "crop_air"
                    },
                    {
                      "config": {
                        "density_threshold": 0.1
                      },
                      "transform": "crop_low_density_bottom_layers"
                    },
                    {
                      "config": {
                        "min_size": [
                          4,
                          4,
                          4
                        ]
                      },
                      "transform": "min_size_filter"
                    },
                    {
                      "config": {
                        "interpolate": true,
                        "interpolation_order": 1,
                        "max_scaling_factor": 2,
                        "max_scaling_factor_ratio": 1.5,
                        "preserve_paths": true,
                        "scale_y_independently": true
                      },
                      "transform": "area_sample"
                    },
                    {
                      "config": {
                        "max_density": 1,
                        "min_density": 0
                      },
                      "transform": "density_filter"
                    },
                    {
                      "transform": "randomly_place"
                    },
                    {
                      "transform": "add_grass"
                    },
                    {
                      "config": {
                        "connectivity": 18
                      },
                      "transform": "single_cc_filter"
                    }
                  ]
                },
                "horizon": 1500,
                "malmo": {
                  "use_malmo": false
                },
                "num_players": 2,
                "players": [
                  {
                    "goal_visible": true,
                    "is_human": false,
                    "player_name": "human",
                    "rewards": {},
                    "timestep_skip": 1
                  },
                  {
                    "goal_visible": true,
                    "is_human": false,
                    "rewards": {},
                    "timestep_skip": 1
                  }
                ],
                "random_start_locations": true,
                "randomize_first_episode_length": true,
                "rewards": {
                  "action": 0,
                  "get_resources": 0,
                  "incorrect_action": 0,
                  "noop": 0,
                  "own_reward_prop": 0,
                  "place_wrong": -1
                },
                "truncate_on_no_progress_timesteps": null,
                "world_size": [
                  11,
                  10,
                  10
                ]
              },
              "filter_size": 5,
              "hidden_channels": 64,
              "hidden_size": 64,
              "interleave_lstm_every": -1,
              "line_of_sight_masking": true,
              "lstm_size": 64,
              "mask_action_distribution": true,
              "mask_goal": false,
              "mask_other_players": false,
              "num_action_layers": 2,
              "num_conv_1_layers": 1,
              "num_inventory_obs": 2,
              "num_layers": 6,
              "num_value_layers": 2,
              "scale_obs": true,
              "use_extra_features": true,
              "use_fc_after_embedding": true,
              "use_groupnorm": false,
              "use_prev_action": true,
              "use_prev_blocks": false,
              "use_resnet": true,
              "vf_scale": 1.0
            },
            "max_seq_len": 1500,
            "vf_share_layers": true
          }
        },
        "observation_space": {
          "_np_random": null,
          "_shape": null,
          "dtype": null,
          "py/object": "gymnasium.spaces.tuple.Tuple",
          "spaces": {
            "py/tuple": [
              {
                "_np_random": null,
                "_shape": {
                  "py/tuple": [
                    6,
                    11,
                    10,
                    10
                  ]
                },
                "bounded_above": {
                  "dtype": "bool",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    6,
                    11,
                    10,
                    10
                  ],
                  "values": "eJztwTENAAAAw6DUv+nZ2AEUAAAAAAAAjwaQQBnJ"
                },
                "bounded_below": {
                  "dtype": "bool",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    6,
                    11,
                    10,
                    10
                  ],
                  "values": "eJztwTENAAAAw6DUv+nZ2AEUAAAAAAAAjwaQQBnJ"
                },
                "dtype": {
                  "dtype": "uint8",
                  "py/object": "numpy.dtype[uint8]"
                },
                "high": {
                  "dtype": "uint8",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    6,
                    11,
                    10,
                    10
                  ],
                  "values": "eJztwTEBAAAAwqD+qWcND6AAAAAAAAB4NCI6r7A="
                },
                "high_repr": "255",
                "low": {
                  "dtype": "uint8",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    6,
                    11,
                    10,
                    10
                  ],
                  "values": "eJztwTEBAAAAwqD1T20ND6AAAAAAAAB4NBnIAAE="
                },
                "low_repr": "0",
                "py/object": "gymnasium.spaces.box.Box"
              },
              {
                "_np_random": null,
                "_shape": {
                  "py/tuple": [
                    2,
                    10
                  ]
                },
                "bounded_above": {
                  "dtype": "bool",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    2,
                    10
                  ],
                  "values": "eJxjZMQEAADmABU="
                },
                "bounded_below": {
                  "dtype": "bool",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    2,
                    10
                  ],
                  "values": "eJxjZMQEAADmABU="
                },
                "dtype": {
                  "dtype": "int32",
                  "py/object": "numpy.dtype[int32]"
                },
                "high": {
                  "byteorder": "<",
                  "dtype": "int32",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    2,
                    10
                  ],
                  "values": "eJxj4GRgYKAiBgAdJAC1"
                },
                "high_repr": "2304",
                "low": {
                  "byteorder": "<",
                  "dtype": "int32",
                  "py/object": "numpy.ndarray",
                  "shape": [
                    2,
                    10
                  ],
                  "values": "eJxjYKAuAAAAUAAB"
                },
                "low_repr": "0",
                "py/object": "gymnasium.spaces.box.Box"
              },
              {
                "_np_random": null,
                "_shape": {
                  "py/tuple": []
                },
                "bounded_above": {
                  "py/id": 61
                },
                "bounded_below": {
                  "dtype": "bool",
                  "py/object": "numpy.bool_",
                  "value": true
                },
                "dtype": {
                  "py/id": 55
                },
                "high": {
                  "dtype": "int32",
                  "py/object": "numpy.ndarray",
                  "values": 2147483647
                },
                "high_repr": "2147483647",
                "low": {
                  "dtype": "int32",
                  "py/object": "numpy.ndarray",
                  "values": 0
                },
                "low_repr": "0",
                "py/object": "gymnasium.spaces.box.Box"
              }
            ]
          }
        },
        "policy_class": {
          "py/type": "mbag.rllib.bc.BCTorchPolicy"
        },
        "py/object": "ray.rllib.policy.policy.PolicySpec"
      }
    },
    "policies_to_train": [
      "human"
    ],
    "policy_map_cache": -1,
    "policy_map_capacity": 100,
    "policy_mapping_fn": {
      "py/function": "mbag.scripts.train.policy_mapping_fn"
    },
    "policy_states_are_swappable": false,
    "postprocess_inputs": false,
    "preprocessor_pref": "deepmind",
    "prioritized_replay": -1,
    "prioritized_replay_alpha": -1,
    "prioritized_replay_beta": -1,
    "prioritized_replay_eps": -1,
    "py/object": "mbag.rllib.bc.BCConfig",
    "recreate_failed_workers": false,
    "remote_env_batch_wait_ms": 0,
    "remote_worker_envs": false,
    "render_env": false,
    "replay_batch_size": -1,
    "replay_mode": -1,
    "replay_sequence_length": null,
    "restart_failed_sub_environments": false,
    "rl_module_spec": null,
    "rollout_fragment_length": 1,
    "sample_async": false,
    "sample_collector": {
      "py/type": "ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector"
    },
    "sampler_perf_stats_ema_coef": null,
    "seed": 0,
    "sgd_minibatch_size": 128,
    "shuffle_buffer_size": 0,
    "simple_optimizer": true,
    "sync_filters_on_rollout_workers_timeout_s": 60.0,
    "synchronize_filters": -1,
    "tf_session_args": {
      "allow_soft_placement": true,
      "device_count": {
        "CPU": 1
      },
      "gpu_options": {
        "allow_growth": true
      },
      "inter_op_parallelism_threads": 2,
      "intra_op_parallelism_threads": 2,
      "log_device_placement": false
    },
    "timesteps_per_iteration": -1,
    "torch_compile_learner": false,
    "torch_compile_learner_dynamo_backend": "inductor",
    "torch_compile_learner_dynamo_mode": null,
    "torch_compile_learner_what_to_compile": {
      "py/reduce": [
        {
          "py/type": "ray.rllib.core.learner.learner.TorchCompileWhatToCompile"
        },
        {
          "py/tuple": [
            "forward_train"
          ]
        }
      ]
    },
    "torch_compile_worker": false,
    "torch_compile_worker_dynamo_backend": "onnxrt",
    "torch_compile_worker_dynamo_mode": null,
    "train_batch_size": 9759,
    "update_worker_filter_stats": true,
    "use_worker_filter_stats": true,
    "validate_workers_after_construction": true,
    "validation_participant_ids": [],
    "vf_loss_coeff": 0,
    "worker_cls": -1,
    "worker_health_probe_timeout_s": 60,
    "worker_restore_timeout_s": 1800
  },
  "conv_config": {
    "dropout": 0.7,
    "embedding_size": 16,
    "env_config": {
      "abilities": {
        "flying": true,
        "inf_blocks": true,
        "teleportation": false
      },
      "goal_generator": {
        "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
      },
      "goal_generator_config": {
        "goal_generator": "craftassist",
        "goal_generator_config": {
          "subset": "train"
        },
        "transforms": [
          {
            "config": {
              "connectivity": 18
            },
            "transform": "largest_cc"
          },
          {
            "transform": "crop_air"
          },
          {
            "config": {
              "density_threshold": 0.1
            },
            "transform": "crop_low_density_bottom_layers"
          },
          {
            "config": {
              "min_size": [
                4,
                4,
                4
              ]
            },
            "transform": "min_size_filter"
          },
          {
            "config": {
              "interpolate": true,
              "interpolation_order": 1,
              "max_scaling_factor": 2,
              "max_scaling_factor_ratio": 1.5,
              "preserve_paths": true,
              "scale_y_independently": true
            },
            "transform": "area_sample"
          },
          {
            "config": {
              "max_density": 1,
              "min_density": 0
            },
            "transform": "density_filter"
          },
          {
            "transform": "randomly_place"
          },
          {
            "transform": "add_grass"
          },
          {
            "config": {
              "connectivity": 18
            },
            "transform": "single_cc_filter"
          }
        ]
      },
      "horizon": 1500,
      "malmo": {
        "use_malmo": false
      },
      "num_players": 2,
      "players": [
        {
          "goal_visible": true,
          "is_human": false,
          "player_name": "human",
          "rewards": {},
          "timestep_skip": 1
        },
        {
          "goal_visible": true,
          "is_human": false,
          "rewards": {},
          "timestep_skip": 1
        }
      ],
      "random_start_locations": true,
      "randomize_first_episode_length": true,
      "rewards": {
        "action": 0,
        "get_resources": 0,
        "incorrect_action": 0,
        "noop": 0,
        "own_reward_prop": 0,
        "place_wrong": -1
      },
      "truncate_on_no_progress_timesteps": null,
      "world_size": [
        11,
        10,
        10
      ]
    },
    "filter_size": 5,
    "hidden_channels": 64,
    "hidden_size": 64,
    "interleave_lstm_every": -1,
    "line_of_sight_masking": true,
    "lstm_size": 64,
    "mask_action_distribution": true,
    "mask_goal": false,
    "mask_other_players": false,
    "num_action_layers": 2,
    "num_conv_1_layers": 1,
    "num_inventory_obs": 2,
    "num_layers": 6,
    "num_value_layers": 2,
    "scale_obs": true,
    "use_extra_features": true,
    "use_fc_after_embedding": true,
    "use_groupnorm": false,
    "use_prev_action": true,
    "use_prev_blocks": false,
    "use_resnet": true,
    "vf_scale": 1.0
  },
  "crop": false,
  "crop_air": true,
  "crop_density_threshold": 0.25,
  "crop_low_density_bottom_layers": true,
  "crop_low_density_config": {
    "density_threshold": 0.1
  },
  "custom_action_dist": "categorical_no_inf",
  "data_augmentation": {
    "py/function": "__main__.data_augmentation"
  },
  "data_split": "human_with_assistant",
  "density_config": {
    "max_density": 1,
    "min_density": 0
  },
  "depth": 10,
  "dim_feedforward": 64,
  "dirichlet_action_subtype_noise_multiplier": 10,
  "dirichlet_epsilon": 0.25,
  "dirichlet_noise": 0.25,
  "dropout": 0.7,
  "embedding_size": 16,
  "entropy_coeff_end": 0,
  "entropy_coeff_horizon": 100000.0,
  "entropy_coeff_schedule": [
    [
      0,
      0
    ],
    [
      100000.0,
      0
    ]
  ],
  "entropy_coeff_start": 0,
  "environment_name": "MBAGFlatActions-v1",
  "environment_params": {
    "abilities": {
      "flying": true,
      "inf_blocks": true,
      "teleportation": false
    },
    "goal_generator": {
      "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
    },
    "goal_generator_config": {
      "goal_generator": "craftassist",
      "goal_generator_config": {
        "subset": "train"
      },
      "transforms": [
        {
          "config": {
            "connectivity": 18
          },
          "transform": "largest_cc"
        },
        {
          "transform": "crop_air"
        },
        {
          "config": {
            "density_threshold": 0.1
          },
          "transform": "crop_low_density_bottom_layers"
        },
        {
          "config": {
            "min_size": [
              4,
              4,
              4
            ]
          },
          "transform": "min_size_filter"
        },
        {
          "config": {
            "interpolate": true,
            "interpolation_order": 1,
            "max_scaling_factor": 2,
            "max_scaling_factor_ratio": 1.5,
            "preserve_paths": true,
            "scale_y_independently": true
          },
          "transform": "area_sample"
        },
        {
          "config": {
            "max_density": 1,
            "min_density": 0
          },
          "transform": "density_filter"
        },
        {
          "transform": "randomly_place"
        },
        {
          "transform": "add_grass"
        },
        {
          "config": {
            "connectivity": 18
          },
          "transform": "single_cc_filter"
        }
      ]
    },
    "horizon": 1500,
    "malmo": {
      "use_malmo": false
    },
    "num_players": 2,
    "players": [
      {
        "goal_visible": true,
        "is_human": false,
        "player_name": "human",
        "rewards": {},
        "timestep_skip": 1
      },
      {
        "goal_visible": true,
        "is_human": false,
        "rewards": {},
        "timestep_skip": 1
      }
    ],
    "random_start_locations": true,
    "randomize_first_episode_length": true,
    "rewards": {
      "action": 0,
      "get_resources": 0,
      "incorrect_action": 0,
      "noop": 0,
      "own_reward_prop": 0,
      "place_wrong": -1
    },
    "truncate_on_no_progress_timesteps": null,
    "world_size": [
      11,
      10,
      10
    ]
  },
  "evaluation_config": {
    "env_config": {
      "num_players": 1,
      "players": [
        {
          "goal_visible": true,
          "is_human": false,
          "rewards": {},
          "timestep_skip": 1
        }
      ],
      "randomize_first_episode_length": false
    },
    "explore": true,
    "input": "sampler"
  },
  "evaluation_duration": 64,
  "evaluation_duration_unit": "episodes",
  "evaluation_explore": true,
  "evaluation_interval": null,
  "evaluation_num_players": 1,
  "evaluation_num_workers": 8,
  "expected_own_reward_scale": 1.0,
  "expected_reward_shift": 0.0,
  "experiment_dir": "data/logs/BC/2_players/11x10x10/craftassist/bc_human/lr_0.001/infinite_blocks_true/human_with_assistant/dropout_0.7/use_prev_action/40_iters/2025-01-06_20-26-00",
  "experiment_name_parts": [
    "BC",
    "2_players",
    "11x10x10",
    "craftassist",
    "bc_human/lr_0.001/infinite_blocks_true/human_with_assistant/dropout_0.7/use_prev_action/40_iters",
    "2025-01-06_20-26-00"
  ],
  "experiment_tag": "bc_human/lr_0.001/infinite_blocks_true/human_with_assistant/dropout_0.7/use_prev_action/40_iters",
  "explore_noops": true,
  "extract_largest_cc": true,
  "extract_largest_cc_connectivity": 18,
  "filter_size": 5,
  "fix_bilevel_action_selection": false,
  "flying": true,
  "force_single_cc": true,
  "force_single_cc_connectivity": 18,
  "gae_lambda": 0.98,
  "gamma": 0.95,
  "get_resources_reward": 0,
  "goal_generator": "craftassist",
  "goal_generator_config": {
    "subset": "train"
  },
  "goal_loss_coeff": 0.5,
  "goal_subset": "train",
  "goal_transforms": [
    {
      "config": {
        "connectivity": 18
      },
      "transform": "largest_cc"
    },
    {
      "transform": "crop_air"
    },
    {
      "config": {
        "density_threshold": 0.1
      },
      "transform": "crop_low_density_bottom_layers"
    },
    {
      "config": {
        "min_size": [
          4,
          4,
          4
        ]
      },
      "transform": "min_size_filter"
    },
    {
      "config": {
        "interpolate": true,
        "interpolation_order": 1,
        "max_scaling_factor": 2,
        "max_scaling_factor_ratio": 1.5,
        "preserve_paths": true,
        "scale_y_independently": true
      },
      "transform": "area_sample"
    },
    {
      "config": {
        "max_density": 1,
        "min_density": 0
      },
      "transform": "density_filter"
    },
    {
      "transform": "randomly_place"
    },
    {
      "transform": "add_grass"
    },
    {
      "config": {
        "connectivity": 18
      },
      "transform": "single_cc_filter"
    }
  ],
  "goal_visibility": [
    true,
    true
  ],
  "grad_clip": 10,
  "height": 10,
  "heuristic": null,
  "hidden_channels": 64,
  "hidden_size": 64,
  "horizon": 1500,
  "incorrect_action_reward": 0,
  "inf_blocks": true,
  "init_q_with_max": false,
  "input": "data/human_data_cleaned/human_with_assistant/infinite_blocks_true/rllib_with_own_noops_flat_actions_flat_observations_place_wrong_reward_-1_repaired_player_1_inventory_0_1",
  "interleave_lstm": false,
  "interleave_lstm_every": -1,
  "is_human": [
    false,
    false
  ],
  "keep_dirt_at_ground_level": true,
  "kl_coeff": 0.2,
  "kl_target": 0.01,
  "line_of_sight_masking": true,
  "load_config_from_checkpoint": false,
  "load_policies_mapping": {},
  "log_dir": "data/logs",
  "lr": 0.001,
  "lr_schedule": [
    [
      0,
      0.001
    ],
    [
      195180.0,
      0.0001
    ]
  ],
  "lr_start": 0.001,
  "lstm_size": 64,
  "mask_action_distribution": true,
  "mask_goal": false,
  "mask_other_players": false,
  "max_density": 1,
  "max_seq_len": 1500,
  "mcts_batch_size": null,
  "min_density": 0,
  "min_depth": 4,
  "min_height": 4,
  "min_size_config": {
    "min_size": [
      4,
      4,
      4
    ]
  },
  "min_width": 4,
  "mirror": false,
  "model": "convolutional",
  "model_config": {
    "custom_action_dist": "categorical_no_inf",
    "custom_model": "mbag_convolutional_model",
    "custom_model_config": {
      "dropout": 0.7,
      "embedding_size": 16,
      "env_config": {
        "abilities": {
          "flying": true,
          "inf_blocks": true,
          "teleportation": false
        },
        "goal_generator": {
          "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
        },
        "goal_generator_config": {
          "goal_generator": "craftassist",
          "goal_generator_config": {
            "subset": "train"
          },
          "transforms": [
            {
              "config": {
                "connectivity": 18
              },
              "transform": "largest_cc"
            },
            {
              "transform": "crop_air"
            },
            {
              "config": {
                "density_threshold": 0.1
              },
              "transform": "crop_low_density_bottom_layers"
            },
            {
              "config": {
                "min_size": [
                  4,
                  4,
                  4
                ]
              },
              "transform": "min_size_filter"
            },
            {
              "config": {
                "interpolate": true,
                "interpolation_order": 1,
                "max_scaling_factor": 2,
                "max_scaling_factor_ratio": 1.5,
                "preserve_paths": true,
                "scale_y_independently": true
              },
              "transform": "area_sample"
            },
            {
              "config": {
                "max_density": 1,
                "min_density": 0
              },
              "transform": "density_filter"
            },
            {
              "transform": "randomly_place"
            },
            {
              "transform": "add_grass"
            },
            {
              "config": {
                "connectivity": 18
              },
              "transform": "single_cc_filter"
            }
          ]
        },
        "horizon": 1500,
        "malmo": {
          "use_malmo": false
        },
        "num_players": 2,
        "players": [
          {
            "goal_visible": true,
            "is_human": false,
            "player_name": "human",
            "rewards": {},
            "timestep_skip": 1
          },
          {
            "goal_visible": true,
            "is_human": false,
            "rewards": {},
            "timestep_skip": 1
          }
        ],
        "random_start_locations": true,
        "randomize_first_episode_length": true,
        "rewards": {
          "action": 0,
          "get_resources": 0,
          "incorrect_action": 0,
          "noop": 0,
          "own_reward_prop": 0,
          "place_wrong": -1
        },
        "truncate_on_no_progress_timesteps": null,
        "world_size": [
          11,
          10,
          10
        ]
      },
      "filter_size": 5,
      "hidden_channels": 64,
      "hidden_size": 64,
      "interleave_lstm_every": -1,
      "line_of_sight_masking": true,
      "lstm_size": 64,
      "mask_action_distribution": true,
      "mask_goal": false,
      "mask_other_players": false,
      "num_action_layers": 2,
      "num_conv_1_layers": 1,
      "num_inventory_obs": 2,
      "num_layers": 6,
      "num_value_layers": 2,
      "scale_obs": true,
      "use_extra_features": true,
      "use_fc_after_embedding": true,
      "use_groupnorm": false,
      "use_prev_action": true,
      "use_prev_blocks": false,
      "use_resnet": true,
      "vf_scale": 1.0
    },
    "max_seq_len": 1500,
    "vf_share_layers": true
  },
  "model_replay_buffer_size": 10,
  "model_replay_buffer_storage_probability": 0.1,
  "model_train_batch_size": 9759,
  "noop_reward": 0,
  "norm_first": false,
  "num_action_layers": 2,
  "num_conv_1_layers": 1,
  "num_cpus_per_worker": 0.5,
  "num_envs": 1,
  "num_envs_per_worker": 8,
  "num_gpus": 1.0,
  "num_gpus_per_worker": 0.0625,
  "num_heads": 4,
  "num_inventory_obs": 2,
  "num_layers": 6,
  "num_lstm_layers": 1,
  "num_players": 2,
  "num_res_blocks": 1,
  "num_sgd_iter": 1,
  "num_simulations": 30,
  "num_training_iters": 40,
  "num_value_layers": 2,
  "num_workers": 0,
  "observation_space": {
    "py/id": 47
  },
  "observer": {
    "basedir": "data/logs/BC/2_players/11x10x10/craftassist/bc_human/lr_0.001/infinite_blocks_true/human_with_assistant/dropout_0.7/use_prev_action/40_iters/2025-01-06_20-26-00",
    "config": {
      "py/id": 0
    },
    "copy_artifacts": true,
    "copy_sources": true,
    "cout": "",
    "cout_write_cursor": 0,
    "dir": "data/logs/BC/2_players/11x10x10/craftassist/bc_human/lr_0.001/infinite_blocks_true/human_with_assistant/dropout_0.7/use_prev_action/40_iters/2025-01-06_20-26-00/1",
    "info": {},
    "priority": 20,
    "py/object": "__main__.NoTypeAnnotationsFileStorageObserver",
    "resource_dir": {
      "py/reduce": [
        {
          "py/type": "pathlib.PosixPath"
        },
        {
          "py/tuple": [
            "data",
            "logs",
            "BC",
            "2_players",
            "11x10x10",
            "craftassist",
            "bc_human",
            "lr_0.001",
            "infinite_blocks_true",
            "human_with_assistant",
            "dropout_0.7",
            "use_prev_action",
            "40_iters",
            "2025-01-06_20-26-00",
            "_resources"
          ]
        }
      ]
    },
    "run_entry": {
      "artifacts": [],
      "command": "main",
      "experiment": {
        "base_dir": "/nas/ucb/cassidy/minecraft-building-assistance-game/mbag/scripts",
        "dependencies": [
          "gymnasium==0.28.1",
          "minecraft-building-assistance-game==0.0.1",
          "numpy==1.21.6",
          "ray==2.7.1",
          "sacred==0.8.4",
          "torch==2.2.0"
        ],
        "mainfile": "train.py",
        "name": "train_mbag",
        "repositories": [
          {
            "commit": "fcbc3318d4898a22af58633039ce61ee8a8165a3",
            "dirty": true,
            "url": "https://github.com/cassidylaidlaw/minecraft-building-assistance-game"
          },
          {
            "commit": "fcbc3318d4898a22af58633039ce61ee8a8165a3",
            "dirty": true,
            "url": "https://github.com/cassidylaidlaw/minecraft-building-assistance-game"
          },
          {
            "commit": "fcbc3318d4898a22af58633039ce61ee8a8165a3",
            "dirty": true,
            "url": "https://github.com/cassidylaidlaw/minecraft-building-assistance-game"
          }
        ],
        "sources": [
          [
            "__init__.py",
            "_sources/__init___d41d8cd98f00b204e9800998ecf8427e.py"
          ],
          [
            "train.py",
            "_sources/train_d15cbc0ac107d1430710fdec12de1b9a.py"
          ],
          [
            "train_configs.py",
            "_sources/train_configs_63585168d914f09090920dbcd630d953.py"
          ]
        ]
      },
      "heartbeat": null,
      "host": {
        "ENV": {},
        "cpu": "AMD EPYC 7763 64-Core Processor",
        "gpus": {
          "driver_version": "535.104.12",
          "gpus": [
            {
              "model": "NVIDIA A100-SXM4-80GB",
              "persistence_mode": true,
              "total_memory": 81920
            }
          ]
        },
        "hostname": "sac.ist.berkeley.edu",
        "os": [
          "Linux",
          "Linux-5.4.0-192-generic-x86_64-with-glibc2.17"
        ],
        "python_version": "3.8.18"
      },
      "meta": {
        "command": "main",
        "config_updates": {
          "checkpoint_name": "none",
          "checkpoint_to_load_policies": null,
          "data_split": "human_with_assistant",
          "dropout": 0.7,
          "evaluation_interval": null,
          "inf_blocks": true,
          "interleave_lstm": false,
          "lr_start": 0.001,
          "norm_first": false,
          "num_training_iters": 40,
          "use_prev_action": true,
          "validation_participant_ids": []
        },
        "named_configs": [
          "bc_human"
        ],
        "options": {
          "--beat-interval": null,
          "--capture": null,
          "--comment": null,
          "--debug": false,
          "--enforce_clean": false,
          "--file_storage": null,
          "--force": false,
          "--help": false,
          "--id": null,
          "--loglevel": null,
          "--mongo_db": null,
          "--name": null,
          "--pdb": false,
          "--print-config": false,
          "--priority": null,
          "--queue": false,
          "--s3": null,
          "--sql": null,
          "--tiny_db": null,
          "--unobserved": false,
          "COMMAND": null,
          "UPDATE": [
            "bc_human",
            "lr_start=1e-3",
            "data_split=human_with_assistant",
            "inf_blocks=True",
            "checkpoint_to_load_policies=None",
            "checkpoint_name=none",
            "use_prev_action=True",
            "interleave_lstm=False",
            "norm_first=False",
            "dropout=0.7",
            "num_training_iters=40",
            "validation_participant_ids=[]",
            "evaluation_interval=None"
          ],
          "help": false,
          "with": true
        }
      },
      "resources": [],
      "start_time": "2025-01-06T20:26:00.241776",
      "status": "RUNNING"
    },
    "source_dir": {
      "py/reduce": [
        {
          "py/type": "pathlib.PosixPath"
        },
        {
          "py/tuple": [
            "data",
            "logs",
            "BC",
            "2_players",
            "11x10x10",
            "craftassist",
            "bc_human",
            "lr_0.001",
            "infinite_blocks_true",
            "human_with_assistant",
            "dropout_0.7",
            "use_prev_action",
            "40_iters",
            "2025-01-06_20-26-00",
            "_sources"
          ]
        }
      ]
    },
    "template": null
  },
  "other_agent_action_predictor_loss_coeff": 1.0,
  "output": null,
  "overwrite_loaded_policy_model": false,
  "overwrite_loaded_policy_type": true,
  "own_reward_prop": 0,
  "per_player_action_reward": null,
  "per_player_get_resources_reward": null,
  "per_player_incorrect_action_reward": null,
  "per_player_noop_reward": null,
  "per_player_own_reward_prop": null,
  "per_player_place_wrong_reward": null,
  "permute_block_types": true,
  "place_block_loss_coeff": 1,
  "place_block_loss_coeff_schedule": null,
  "place_wrong_reward": -1,
  "player_config": {
    "goal_visible": true,
    "is_human": false,
    "rewards": {},
    "timestep_skip": 1
  },
  "player_configs": [
    {
      "goal_visible": true,
      "is_human": false,
      "rewards": {},
      "timestep_skip": 1
    },
    {
      "goal_visible": true,
      "is_human": false,
      "rewards": {},
      "timestep_skip": 1
    }
  ],
  "player_index": 0,
  "players_str": "2_players",
  "policies": {
    "human": {
      "py/id": 46
    }
  },
  "policies_to_train": [
    "human"
  ],
  "policy_class": {
    "py/type": "mbag.rllib.bc.BCTorchPolicy"
  },
  "policy_config": {
    "goal_loss_coeff": 0.5,
    "model": {
      "custom_action_dist": "categorical_no_inf",
      "custom_model": "mbag_convolutional_model",
      "custom_model_config": {
        "dropout": 0.7,
        "embedding_size": 16,
        "env_config": {
          "abilities": {
            "flying": true,
            "inf_blocks": true,
            "teleportation": false
          },
          "goal_generator": {
            "py/type": "mbag.environment.goals.goal_transform.TransformedGoalGenerator"
          },
          "goal_generator_config": {
            "goal_generator": "craftassist",
            "goal_generator_config": {
              "subset": "train"
            },
            "transforms": [
              {
                "config": {
                  "connectivity": 18
                },
                "transform": "largest_cc"
              },
              {
                "transform": "crop_air"
              },
              {
                "config": {
                  "density_threshold": 0.1
                },
                "transform": "crop_low_density_bottom_layers"
              },
              {
                "config": {
                  "min_size": [
                    4,
                    4,
                    4
                  ]
                },
                "transform": "min_size_filter"
              },
              {
                "config": {
                  "interpolate": true,
                  "interpolation_order": 1,
                  "max_scaling_factor": 2,
                  "max_scaling_factor_ratio": 1.5,
                  "preserve_paths": true,
                  "scale_y_independently": true
                },
                "transform": "area_sample"
              },
              {
                "config": {
                  "max_density": 1,
                  "min_density": 0
                },
                "transform": "density_filter"
              },
              {
                "transform": "randomly_place"
              },
              {
                "transform": "add_grass"
              },
              {
                "config": {
                  "connectivity": 18
                },
                "transform": "single_cc_filter"
              }
            ]
          },
          "horizon": 1500,
          "malmo": {
            "use_malmo": false
          },
          "num_players": 2,
          "players": [
            {
              "goal_visible": true,
              "is_human": false,
              "player_name": "human",
              "rewards": {},
              "timestep_skip": 1
            },
            {
              "goal_visible": true,
              "is_human": false,
              "rewards": {},
              "timestep_skip": 1
            }
          ],
          "random_start_locations": true,
          "randomize_first_episode_length": true,
          "rewards": {
            "action": 0,
            "get_resources": 0,
            "incorrect_action": 0,
            "noop": 0,
            "own_reward_prop": 0,
            "place_wrong": -1
          },
          "truncate_on_no_progress_timesteps": null,
          "world_size": [
            11,
            10,
            10
          ]
        },
        "filter_size": 5,
        "hidden_channels": 64,
        "hidden_size": 64,
        "interleave_lstm_every": -1,
        "line_of_sight_masking": true,
        "lstm_size": 64,
        "mask_action_distribution": true,
        "mask_goal": false,
        "mask_other_players": false,
        "num_action_layers": 2,
        "num_conv_1_layers": 1,
        "num_inventory_obs": 2,
        "num_layers": 6,
        "num_value_layers": 2,
        "scale_obs": true,
        "use_extra_features": true,
        "use_fc_after_embedding": true,
        "use_groupnorm": false,
        "use_prev_action": true,
        "use_prev_blocks": false,
        "use_resnet": true,
        "vf_scale": 1.0
      },
      "max_seq_len": 1500,
      "vf_share_layers": true
    }
  },
  "policy_id": "human",
  "policy_ids": [
    "human"
  ],
  "policy_loss_coeff": 1,
  "policy_mapping_fn": {
    "py/function": "__main__.policy_mapping_fn"
  },
  "position_embedding_angle": 10,
  "position_embedding_size": 48,
  "predict_goal_using_average": false,
  "predict_goal_using_future_states": false,
  "predict_goal_using_next_state": false,
  "pretrain": false,
  "prev_goal_kl_coeff": 0,
  "prev_goal_kl_coeff_schedule": null,
  "prev_policy_kl_coeff": 0,
  "prior_temperature": 1.0,
  "puct_coefficient": 1.0,
  "puct_str": null,
  "random_start_locations": true,
  "randomize_first_episode_length": true,
  "ray_init_options": {},
  "remove_invisible_non_dirt": false,
  "replay_buffer_size": 10,
  "replay_buffer_storage_unit": {
    "py/reduce": [
      {
        "py/type": "ray.rllib.utils.replay_buffers.replay_buffer.StorageUnit"
      },
      {
        "py/tuple": [
          "fragments"
        ]
      }
    ]
  },
  "resblock_updown": true,
  "reward_scale": 1.0,
  "rollout_fragment_length": 1,
  "run": "BC",
  "sample_batch_size": 5000,
  "sample_c_puct_every_timestep": true,
  "sample_freq": 1,
  "sample_from_full_support_policy": false,
  "save_freq": 1,
  "scale_obs": true,
  "seed": 0,
  "sgd_minibatch_size": 128,
  "simple_optimizer": true,
  "size_str": "11x10x10",
  "store_model_state_in_torch": false,
  "strict_mode": false,
  "teleportation": false,
  "temperature": 1.5,
  "temperature_end": 1.5,
  "temperature_horizon": 390360,
  "temperature_start": 1.5,
  "timestep_skip": [
    1,
    1
  ],
  "train_batch_size": 9759,
  "transformed_goal_generator_config": {
    "goal_generator": "craftassist",
    "goal_generator_config": {
      "subset": "train"
    },
    "transforms": [
      {
        "config": {
          "connectivity": 18
        },
        "transform": "largest_cc"
      },
      {
        "transform": "crop_air"
      },
      {
        "config": {
          "density_threshold": 0.1
        },
        "transform": "crop_low_density_bottom_layers"
      },
      {
        "config": {
          "min_size": [
            4,
            4,
            4
          ]
        },
        "transform": "min_size_filter"
      },
      {
        "config": {
          "interpolate": true,
          "interpolation_order": 1,
          "max_scaling_factor": 2,
          "max_scaling_factor_ratio": 1.5,
          "preserve_paths": true,
          "scale_y_independently": true
        },
        "transform": "area_sample"
      },
      {
        "config": {
          "max_density": 1,
          "min_density": 0
        },
        "transform": "density_filter"
      },
      {
        "transform": "randomly_place"
      },
      {
        "transform": "add_grass"
      },
      {
        "config": {
          "connectivity": 18
        },
        "transform": "single_cc_filter"
      }
    ]
  },
  "truncate_on_no_progress_timesteps": null,
  "uniform_block_type": false,
  "use_anchor_policy": false,
  "use_bilevel_action_selection": true,
  "use_critic": true,
  "use_extra_features": true,
  "use_fc_after_embedding": true,
  "use_goal_predictor": true,
  "use_groupnorm": false,
  "use_lstm": false,
  "use_model_replay_buffer": false,
  "use_prev_action": true,
  "use_prev_blocks": false,
  "use_prev_other_agent_action": false,
  "use_replay_buffer": true,
  "use_resnet": true,
  "use_scale_shift_norm": true,
  "use_separated_transformer": true,
  "validation_participant_ids": [],
  "vf_loss_coeff": 0,
  "vf_scale": 1.0,
  "vf_share_layers": true,
  "wall": false,
  "weight_decay": 0,
  "width": 11
}